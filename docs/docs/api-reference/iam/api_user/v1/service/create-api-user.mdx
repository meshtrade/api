# CreateApiUser

Creates a new API user with the specified configuration.

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import serviceData from '../service.generated.json';

## Method Details

**Description:** {serviceData.methods.CreateApiUser.description}

**Authorization:** {serviceData.methods.CreateApiUser.authorization}

**Parameters:** {serviceData.methods.CreateApiUser.parameters}

**Returns:** {serviceData.methods.CreateApiUser.returns}

**Method Type:** {serviceData.methods.CreateApiUser.method_type}

## Code Examples

<Tabs>
<TabItem value="go" label="Go">

```go title="main.go"
package main

import (
	"context"
	"log"

	api_userv1 "github.com/meshtrade/api/go/iam/api_user/v1"
	rolev1 "github.com/meshtrade/api/go/iam/role/v1"
)

func main() {
	// Create client (loads credentials from MESH_API_CREDENTIALS)
	client, err := api_userv1.NewApiUserServiceGRPCClient()
	if err != nil {
		log.Fatalf("Failed to create client: %v", err)
	}
	defer client.Close()

	// Prepare API user configuration
	apiUserToCreate := &api_userv1.APIUser{
		DisplayName: "My API User",
		Roles: []rolev1.Role{
			rolev1.Role_ROLE_IAM_ADMIN,
		},
	}

	// Create the new API user
	apiUser, err := client.CreateApiUser(
		context.Background(),
		&api_userv1.CreateApiUserRequest{
			ApiUser: apiUserToCreate,
		},
	)
	if err != nil {
		log.Fatalf("Failed to create API user: %v", err)
	}

	log.Printf("Created API user: %s", apiUser.Name)
	log.Printf("Display name: %s", apiUser.DisplayName)
	log.Printf("API key: %s", apiUser.ApiKey) // Only shown on creation
}
```

</TabItem>
<TabItem value="python" label="Python">

```python title="create-api-user.py"
import grpc
import json
import os
from meshtrade.iam.api_user.v1 import service_pb2, service_pb2_grpc, api_user_pb2
from meshtrade.option.v1 import role_pb2

def load_credentials():
    """Load credentials from MESH_API_CREDENTIALS file."""
    creds_path = os.getenv('MESH_API_CREDENTIALS')
    with open(creds_path, 'r') as f:
        return json.load(f)

def main():
    # Load credentials
    creds = load_credentials()
    
    # Create gRPC channel and client
    channel = grpc.insecure_channel('api.mesh.dev:443')
    client = service_pb2_grpc.ApiUserServiceStub(channel)
    
    # Authentication metadata
    metadata = [
        ('authorization', f'Bearer {creds["api_key"]}'),
        ('x-group-id', creds['group_id']),
    ]
    
    try:
        # Create API user configuration
        api_user = api_user_pb2.APIUser(
            display_name="My API User",
            roles=[role_pb2.Role.ROLE_IAM_ADMIN]
        )
        
        # Create request
        request = service_pb2.CreateApiUserRequest(api_user=api_user)
        
        # Make the API call
        response = client.CreateApiUser(request, metadata=metadata)
        
        print(f"Created API user: {response.name}")
        print(f"Display name: {response.display_name}")
        print(f"API key: {response.api_key}")  # Only shown on creation
        
    except grpc.RpcError as e:
        print(f"Failed to create API user: {e}")
    
    finally:
        channel.close()

if __name__ == "__main__":
    main()
```

</TabItem>
</Tabs>

## Related Methods

- **[ActivateApiUser](./activate-api-user)** - Activate the newly created API user
- **[GetApiUser](./get-api-user)** - Retrieve the created API user details
- **[ListApiUsers](./list-api-users)** - List all API users in the group
