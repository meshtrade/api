---
sidebar_position: 3
---

# Service Methods

Complete documentation for all API User Service methods with working code examples.

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import serviceData from './service.generated.json';

## Service Overview

**{serviceData.service.name}**

{serviceData.service.description}

**Authentication:** {serviceData.service.authentication_required ? 'Required' : 'Not required'}  
**Group Context:** {serviceData.service.group_context_required ? 'Required' : 'Not required'}

---

## CreateApiUser

**Description:** {serviceData.methods.CreateApiUser.description}

**Authorization:** {serviceData.methods.CreateApiUser.authorization}

**Parameters:** {serviceData.methods.CreateApiUser.parameters}

**Returns:** {serviceData.methods.CreateApiUser.returns}

<Tabs>
<TabItem value="go" label="Go">

```go title="create-api-user.go"
package main

import (
	"context"
	"log"

	api_userv1 "github.com/meshtrade/api/go/iam/api_user/v1"
	optionv1 "github.com/meshtrade/api/go/option/v1"
)

func main() {
	// Create client (see client-setup.go for details)
	client, err := api_userv1.NewApiUserServiceGRPCClient(
		api_userv1.WithAddress("localhost", 8080),
		api_userv1.WithTLS(false),
		api_userv1.WithAPIKey("your-api-key"),
		api_userv1.WithGroup("your-group-id"),
	)
	if err != nil {
		log.Fatalf("Failed to create client: %v", err)
	}
	defer client.Close()

	// Prepare API user configuration
	apiUserToCreate := &api_userv1.APIUser{
		Owner:       "groups/your-group-id",
		DisplayName: "My API User",
		Roles: []optionv1.Role{
			optionv1.Role_ROLE_IAM_ADMIN,
		},
	}

	// Create the new API user
	apiUser, err := client.CreateApiUser(
		context.Background(),
		&api_userv1.CreateApiUserRequest{
			ApiUser: apiUserToCreate,
		},
	)
	if err != nil {
		log.Fatalf("Failed to create API user: %v", err)
	}

	log.Printf("Created API user: %s", apiUser.Name)
	log.Printf("Display name: %s", apiUser.DisplayName)
	log.Printf("API key: %s", apiUser.ApiKey) // Only shown on creation
}
```

</TabItem>
<TabItem value="python" label="Python">

```python title="create-api-user.py"
import grpc
from meshtrade.iam.api_user.v1 import service_pb2, service_pb2_grpc, api_user_pb2
from meshtrade.option.v1 import role_pb2


def create_client_and_metadata():
    """Create client and authentication metadata."""
    channel = grpc.insecure_channel('localhost:8080')
    client = service_pb2_grpc.ApiUserServiceStub(channel)
    metadata = [
        ('authorization', 'Bearer your-api-key'),
        ('x-group-id', 'your-group-id'),
    ]
    return client, channel, metadata


def main():
    # Create client and metadata
    client, channel, metadata = create_client_and_metadata()
    
    try:
        # Create API user configuration
        api_user = api_user_pb2.APIUser(
            owner="groups/your-group-id",
            display_name="My API User",
            roles=[role_pb2.Role.ROLE_IAM_ADMIN]
        )
        
        # Create request
        request = service_pb2.CreateApiUserRequest(api_user=api_user)
        
        # Make the API call
        response = client.CreateApiUser(request, metadata=metadata)
        
        print(f"Created API user: {response.name}")
        print(f"Display name: {response.display_name}")
        print(f"API key: {response.api_key}")  # Only shown on creation
        
    except grpc.RpcError as e:
        print(f"Failed to create API user: {e}")
    
    finally:
        channel.close()


if __name__ == "__main__":
    main()
```

</TabItem>
</Tabs>

---

## GetApiUser

**Description:** {serviceData.methods.GetApiUser.description}

**Authorization:** {serviceData.methods.GetApiUser.authorization}

**Parameters:** {serviceData.methods.GetApiUser.parameters}

**Returns:** {serviceData.methods.GetApiUser.returns}

<Tabs>
<TabItem value="go" label="Go">

```go title="get-api-user.go"
package main

import (
	"context"
	"log"

	api_userv1 "github.com/meshtrade/api/go/iam/api_user/v1"
)

func main() {
	// Create client (see client-setup.go for details)
	client, err := api_userv1.NewApiUserServiceGRPCClient(
		api_userv1.WithAddress("localhost", 8080),
		api_userv1.WithTLS(false),
		api_userv1.WithAPIKey("your-api-key"),
		api_userv1.WithGroup("your-group-id"),
	)
	if err != nil {
		log.Fatalf("Failed to create client: %v", err)
	}
	defer client.Close()

	// Get a specific API user by name
	apiUser, err := client.GetApiUser(
		context.Background(),
		&api_userv1.GetApiUserRequest{
			Name: "api_users/01HPQR2S3T4U5V6W7X8Y9Z0123", // Replace with actual API user name
		},
	)
	if err != nil {
		log.Fatalf("Failed to get API user: %v", err)
	}

	log.Printf("API User: %s", apiUser.Name)
	log.Printf("Display Name: %s", apiUser.DisplayName)
	log.Printf("Owner: %s", apiUser.Owner)
	log.Printf("State: %v", apiUser.State)
	log.Printf("Roles: %v", apiUser.Roles)
}
```

</TabItem>
<TabItem value="python" label="Python">

```python title="get-api-user.py"
import grpc
from meshtrade.iam.api_user.v1 import service_pb2, service_pb2_grpc


def create_client_and_metadata():
    """Create client and authentication metadata."""
    channel = grpc.insecure_channel('localhost:8080')
    client = service_pb2_grpc.ApiUserServiceStub(channel)
    metadata = [
        ('authorization', 'Bearer your-api-key'),
        ('x-group-id', 'your-group-id'),
    ]
    return client, channel, metadata


def main():
    # Create client and metadata
    client, channel, metadata = create_client_and_metadata()
    
    try:
        # Create request
        request = service_pb2.GetApiUserRequest(
            name="api_users/01HPQR2S3T4U5V6W7X8Y9Z0123"  # Replace with actual API user name
        )
        
        # Make the API call
        response = client.GetApiUser(request, metadata=metadata)
        
        print(f"API User: {response.name}")
        print(f"Display Name: {response.display_name}")
        print(f"Owner: {response.owner}")
        print(f"State: {response.state}")
        print(f"Roles: {response.roles}")
        
    except grpc.RpcError as e:
        print(f"Failed to get API user: {e}")
    
    finally:
        channel.close()


if __name__ == "__main__":
    main()
```

</TabItem>
</Tabs>

---

## ListApiUsers

**Description:** {serviceData.methods.ListApiUsers.description}

**Authorization:** {serviceData.methods.ListApiUsers.authorization}

**Parameters:** {serviceData.methods.ListApiUsers.parameters}

**Returns:** {serviceData.methods.ListApiUsers.returns}

<Tabs>
<TabItem value="go" label="Go">

```go title="list-api-users.go"
package main

import (
	"context"
	"log"

	api_userv1 "github.com/meshtrade/api/go/iam/api_user/v1"
)

func main() {
	// Create client (see client-setup.go for details)
	client, err := api_userv1.NewApiUserServiceGRPCClient(
		api_userv1.WithAddress("localhost", 8080),
		api_userv1.WithTLS(false),
		api_userv1.WithAPIKey("your-api-key"),
		api_userv1.WithGroup("your-group-id"),
	)
	if err != nil {
		log.Fatalf("Failed to create client: %v", err)
	}
	defer client.Close()

	// List all API users in the group
	response, err := client.ListApiUsers(
		context.Background(),
		&api_userv1.ListApiUsersRequest{},
	)
	if err != nil {
		log.Fatalf("Failed to list API users: %v", err)
	}

	log.Printf("Found %d API users:", len(response.ApiUsers))
	for _, apiUser := range response.ApiUsers {
		log.Printf("- %s (%s) - State: %v", 
			apiUser.Name, 
			apiUser.DisplayName, 
			apiUser.State)
	}
}
```

</TabItem>
<TabItem value="python" label="Python">

```python title="list-api-users.py"
import grpc
from meshtrade.iam.api_user.v1 import service_pb2, service_pb2_grpc


def create_client_and_metadata():
    """Create client and authentication metadata."""
    channel = grpc.insecure_channel('localhost:8080')
    client = service_pb2_grpc.ApiUserServiceStub(channel)
    metadata = [
        ('authorization', 'Bearer your-api-key'),
        ('x-group-id', 'your-group-id'),
    ]
    return client, channel, metadata


def main():
    # Create client and metadata
    client, channel, metadata = create_client_and_metadata()
    
    try:
        # Create request (empty for list all)
        request = service_pb2.ListApiUsersRequest()
        
        # Make the API call
        response = client.ListApiUsers(request, metadata=metadata)
        
        print(f"Found {len(response.api_users)} API users:")
        for api_user in response.api_users:
            print(f"- {api_user.name} ({api_user.display_name}) - State: {api_user.state}")
        
    except grpc.RpcError as e:
        print(f"Failed to list API users: {e}")
    
    finally:
        channel.close()


if __name__ == "__main__":
    main()
```

</TabItem>
</Tabs>

---

## SearchApiUsers

**Description:** {serviceData.methods.SearchApiUsers.description}

**Authorization:** {serviceData.methods.SearchApiUsers.authorization}

**Parameters:** {serviceData.methods.SearchApiUsers.parameters}

**Returns:** {serviceData.methods.SearchApiUsers.returns}

<Tabs>
<TabItem value="go" label="Go">

```go title="search-api-users.go"
package main

import (
	"context"
	"log"

	api_userv1 "github.com/meshtrade/api/go/iam/api_user/v1"
)

func main() {
	// Create client (see client-setup.go for details)
	client, err := api_userv1.NewApiUserServiceGRPCClient(
		api_userv1.WithAddress("localhost", 8080),
		api_userv1.WithTLS(false),
		api_userv1.WithAPIKey("your-api-key"),
		api_userv1.WithGroup("your-group-id"),
	)
	if err != nil {
		log.Fatalf("Failed to create client: %v", err)
	}
	defer client.Close()

	// Search API users by display name substring
	response, err := client.SearchApiUsers(
		context.Background(),
		&api_userv1.SearchApiUsersRequest{
			DisplayName: "test", // Search for API users with "test" in display name
		},
	)
	if err != nil {
		log.Fatalf("Failed to search API users: %v", err)
	}

	log.Printf("Found %d API users matching 'test':", len(response.ApiUsers))
	for _, apiUser := range response.ApiUsers {
		log.Printf("- %s (%s)", apiUser.Name, apiUser.DisplayName)
	}
}
```

</TabItem>
<TabItem value="python" label="Python">

```python title="search-api-users.py"
import grpc
from meshtrade.iam.api_user.v1 import service_pb2, service_pb2_grpc


def create_client_and_metadata():
    """Create client and authentication metadata."""
    channel = grpc.insecure_channel('localhost:8080')
    client = service_pb2_grpc.ApiUserServiceStub(channel)
    metadata = [
        ('authorization', 'Bearer your-api-key'),
        ('x-group-id', 'your-group-id'),
    ]
    return client, channel, metadata


def main():
    # Create client and metadata
    client, channel, metadata = create_client_and_metadata()
    
    try:
        # Create request with search term
        request = service_pb2.SearchApiUsersRequest(
            display_name="test"  # Search for API users with "test" in display name
        )
        
        # Make the API call
        response = client.SearchApiUsers(request, metadata=metadata)
        
        print(f"Found {len(response.api_users)} API users matching 'test':")
        for api_user in response.api_users:
            print(f"- {api_user.name} ({api_user.display_name})")
        
    except grpc.RpcError as e:
        print(f"Failed to search API users: {e}")
    
    finally:
        channel.close()


if __name__ == "__main__":
    main()
```

</TabItem>
</Tabs>

---

## ActivateApiUser

**Description:** {serviceData.methods.ActivateApiUser.description}

**Authorization:** {serviceData.methods.ActivateApiUser.authorization}

**Parameters:** {serviceData.methods.ActivateApiUser.parameters}

**Returns:** {serviceData.methods.ActivateApiUser.returns}

<Tabs>
<TabItem value="go" label="Go">

```go title="activate-api-user.go"
package main

import (
	"context"
	"log"

	api_userv1 "github.com/meshtrade/api/go/iam/api_user/v1"
)

func main() {
	// Create client (see client-setup.go for details)
	client, err := api_userv1.NewApiUserServiceGRPCClient(
		api_userv1.WithAddress("localhost", 8080),
		api_userv1.WithTLS(false),
		api_userv1.WithAPIKey("your-api-key"),
		api_userv1.WithGroup("your-group-id"),
	)
	if err != nil {
		log.Fatalf("Failed to create client: %v", err)
	}
	defer client.Close()

	// Activate the API user by name
	apiUser, err := client.ActivateApiUser(
		context.Background(),
		&api_userv1.ActivateApiUserRequest{
			Name: "api_users/01HPQR2S3T4U5V6W7X8Y9Z0123", // Replace with actual API user name
		},
	)
	if err != nil {
		log.Fatalf("Failed to activate API user: %v", err)
	}

	log.Printf("Activated API user: %s", apiUser.Name)
	log.Printf("State: %v", apiUser.State)
}
```

</TabItem>
<TabItem value="python" label="Python">

```python title="activate-api-user.py"
import grpc
from meshtrade.iam.api_user.v1 import service_pb2, service_pb2_grpc


def create_client_and_metadata():
    """Create client and authentication metadata."""
    channel = grpc.insecure_channel('localhost:8080')
    client = service_pb2_grpc.ApiUserServiceStub(channel)
    metadata = [
        ('authorization', 'Bearer your-api-key'),
        ('x-group-id', 'your-group-id'),
    ]
    return client, channel, metadata


def main():
    # Create client and metadata
    client, channel, metadata = create_client_and_metadata()
    
    try:
        # Create request
        request = service_pb2.ActivateApiUserRequest(
            name="api_users/01HPQR2S3T4U5V6W7X8Y9Z0123"  # Replace with actual API user name
        )
        
        # Make the API call
        response = client.ActivateApiUser(request, metadata=metadata)
        
        print(f"Activated API user: {response.name}")
        print(f"State: {response.state}")
        
    except grpc.RpcError as e:
        print(f"Failed to activate API user: {e}")
    
    finally:
        channel.close()


if __name__ == "__main__":
    main()
```

</TabItem>
</Tabs>

---

## DeactivateApiUser

**Description:** {serviceData.methods.DeactivateApiUser.description}

**Authorization:** {serviceData.methods.DeactivateApiUser.authorization}

**Parameters:** {serviceData.methods.DeactivateApiUser.parameters}

**Returns:** {serviceData.methods.DeactivateApiUser.returns}

<Tabs>
<TabItem value="go" label="Go">

```go title="deactivate-api-user.go"
package main

import (
	"context"
	"log"

	api_userv1 "github.com/meshtrade/api/go/iam/api_user/v1"
)

func main() {
	// Create client (see client-setup.go for details)
	client, err := api_userv1.NewApiUserServiceGRPCClient(
		api_userv1.WithAddress("localhost", 8080),
		api_userv1.WithTLS(false),
		api_userv1.WithAPIKey("your-api-key"),
		api_userv1.WithGroup("your-group-id"),
	)
	if err != nil {
		log.Fatalf("Failed to create client: %v", err)
	}
	defer client.Close()

	// Deactivate the API user by name
	apiUser, err := client.DeactivateApiUser(
		context.Background(),
		&api_userv1.DeactivateApiUserRequest{
			Name: "api_users/01HPQR2S3T4U5V6W7X8Y9Z0123", // Replace with actual API user name
		},
	)
	if err != nil {
		log.Fatalf("Failed to deactivate API user: %v", err)
	}

	log.Printf("Deactivated API user: %s", apiUser.Name)
	log.Printf("State: %v", apiUser.State)
}
```

</TabItem>
<TabItem value="python" label="Python">

```python title="deactivate-api-user.py"
import grpc
from meshtrade.iam.api_user.v1 import service_pb2, service_pb2_grpc


def create_client_and_metadata():
    """Create client and authentication metadata."""
    channel = grpc.insecure_channel('localhost:8080')
    client = service_pb2_grpc.ApiUserServiceStub(channel)
    metadata = [
        ('authorization', 'Bearer your-api-key'),
        ('x-group-id', 'your-group-id'),
    ]
    return client, channel, metadata


def main():
    # Create client and metadata
    client, channel, metadata = create_client_and_metadata()
    
    try:
        # Create request
        request = service_pb2.DeactivateApiUserRequest(
            name="api_users/01HPQR2S3T4U5V6W7X8Y9Z0123"  # Replace with actual API user name
        )
        
        # Make the API call
        response = client.DeactivateApiUser(request, metadata=metadata)
        
        print(f"Deactivated API user: {response.name}")
        print(f"State: {response.state}")
        
    except grpc.RpcError as e:
        print(f"Failed to deactivate API user: {e}")
    
    finally:
        channel.close()


if __name__ == "__main__":
    main()
```

</TabItem>
</Tabs>

---

## GetApiUserByKeyHash

**Description:** {serviceData.methods.GetApiUserByKeyHash.description}

**Authorization:** {serviceData.methods.GetApiUserByKeyHash.authorization}

**Parameters:** {serviceData.methods.GetApiUserByKeyHash.parameters}

**Returns:** {serviceData.methods.GetApiUserByKeyHash.returns}

<Tabs>
<TabItem value="go" label="Go">

```go title="get-api-user-by-key-hash.go"
package main

import (
	"context"
	"log"

	api_userv1 "github.com/meshtrade/api/go/iam/api_user/v1"
)

func main() {
	// Create client (see client-setup.go for details)
	client, err := api_userv1.NewApiUserServiceGRPCClient(
		api_userv1.WithAddress("localhost", 8080),
		api_userv1.WithTLS(false),
		api_userv1.WithAPIKey("your-api-key"),
		api_userv1.WithGroup("your-group-id"),
	)
	if err != nil {
		log.Fatalf("Failed to create client: %v", err)
	}
	defer client.Close()

	// Get API user by key hash (typically used for authentication flows)
	apiUser, err := client.GetApiUserByKeyHash(
		context.Background(),
		&api_userv1.GetApiUserByKeyHashRequest{
			KeyHash: "abcd1234hash5678", // Replace with actual key hash
		},
	)
	if err != nil {
		log.Fatalf("Failed to get API user by key hash: %v", err)
	}

	log.Printf("Found API User: %s", apiUser.Name)
	log.Printf("Display Name: %s", apiUser.DisplayName)
	log.Printf("State: %v", apiUser.State)
}
```

</TabItem>
<TabItem value="python" label="Python">

```python title="get-api-user-by-key-hash.py"
import grpc
from meshtrade.iam.api_user.v1 import service_pb2, service_pb2_grpc


def create_client_and_metadata():
    """Create client and authentication metadata."""
    channel = grpc.insecure_channel('localhost:8080')
    client = service_pb2_grpc.ApiUserServiceStub(channel)
    metadata = [
        ('authorization', 'Bearer your-api-key'),
        ('x-group-id', 'your-group-id'),
    ]
    return client, channel, metadata


def main():
    # Create client and metadata
    client, channel, metadata = create_client_and_metadata()
    
    try:
        # Create request
        request = service_pb2.GetApiUserByKeyHashRequest(
            key_hash="abcd1234hash5678"  # Replace with actual key hash
        )
        
        # Make the API call
        response = client.GetApiUserByKeyHash(request, metadata=metadata)
        
        print(f"Found API User: {response.name}")
        print(f"Display Name: {response.display_name}")
        print(f"State: {response.state}")
        
    except grpc.RpcError as e:
        print(f"Failed to get API user by key hash: {e}")
    
    finally:
        channel.close()


if __name__ == "__main__":
    main()
```

</TabItem>
</Tabs>
