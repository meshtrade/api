syntax = "proto3";

package meshtrade.reporting.income_report.v1;

import "google/protobuf/timestamp.proto";
import "meshtrade/type/v1/token.proto";
import "meshtrade/reporting/income_report/v1/income_report.proto";

option go_package = "github.com/meshtrade/api/go/reporting/income_report/v1;income_reportv1";

/*
   IncomeReportService manages income report generation and export.

   This service allows clients to retrieve structured income reports
   and download them as Excel files. Reports are generated for a
   specified account over a given time range and denominated in
   a selected reporting currency.

   All operations require access to financial reporting permissions.
*/
service IncomeReportService {
  /*
     Retrieves a structured income report for a specific account and time range.

     Parameters:
     - account_num: Unique account identifier
     - from: Start timestamp for the report period
     - to: End timestamp for the report period
     - reporting_currency_token: Token in which report values are denominated

     Returns:
     - GetIncomeReportResponse: Structured income report with earnings breakdown
  */
  rpc GetIncomeReport(GetIncomeReportRequest) returns (GetIncomeReportResponse);

  /*
     Exports an income report to Excel format for download.

     Parameters:
     - account_num: Unique account identifier
     - from: Start timestamp for the report period
     - to: End timestamp for the report period
     - reporting_currency_token: Token in which report values are denominated

     Returns:
     - GetExcelIncomeReportResponse: Base64-encoded Excel file containing the report
  */
  rpc GetExcelIncomeReport(GetExcelIncomeReportRequest) returns (GetExcelIncomeReportResponse);
}

message GetIncomeReportRequest {
  /*
     Unique account number for which the income report is requested.
  */
  string account_num = 1;

  /*
     Start of the reporting period (inclusive).
  */
  google.protobuf.Timestamp from = 2;

  /*
     End of the reporting period (inclusive).
  */
  google.protobuf.Timestamp to = 3;

  /*
     Token representing the currency in which the report will be calculated.
  */
  meshtrade.type.v1.Token reporting_currency_token = 4;
}

message GetIncomeReportResponse {
  /*
     Structured income report with detailed earnings information.
  */
  reporting.income_report.v1.IncomeReport income_report = 1;
}

message GetExcelIncomeReportRequest {
  /*
     Unique account number for which the Excel export is requested.
  */
  string account_num = 1;

  /*
     Start of the reporting period (inclusive).
  */
  google.protobuf.Timestamp from = 2;

  /*
     End of the reporting period (inclusive).
  */
  google.protobuf.Timestamp to = 3;

  /*
     Token representing the currency in which the Excel report will be calculated.
  */
  meshtrade.type.v1.Token reporting_currency_token = 4;
}

message GetExcelIncomeReportResponse {
  /*
     Base64-encoded binary content of the Excel report file.
  */
  string excel_base64 = 1;
}
